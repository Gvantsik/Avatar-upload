# Terms of reference for a test assignment for nodejs.

## Formulation of the task

### Given

Project on `express` database `postgresql`, `docker-compose` file with the described database container.

The project implements a simple one entity `CRUD`, which saves data to the corresponding table in the database using `knexjs`.

### Required

Implement `CRUD` of another entity - `Users`. Entity consists of fields specified in the `technical requirements`. Among others, the request may include a file - the user's avatar, which must be saved to the file system.

## Technical requirements

### Basic requirements

1. It is forbidden to change the code everywhere, except for the file `src/index.js`. However, it is allowed to create new files inside the `src` directory.

2. The project is configured with `prettier` and `eslint`. The code must pass all the eslint checks and must be formatted according to the settings in `.perttierrc`. Solutions that do not meet this requirement will be eliminated automatically, and their performance will not be checked. It is also forbidden to use the `eslint-disable-*` directives.

3. It is forbidden to use any third-party libraries. All the code must be written in `nodejs`, `express` and `knex`.

4. Credentials to the database will be in the `.env` file, and `knex` will be used to connect. In addition to the project, a file `docker-compose.yaml` will be added, which will describe the container for the database. To "raise" the container, you need to run the command `docker-compose up -d db` from the root of the project. You also need to install `docker` and `docker-compose`. It is allowed not to use `docker-compose`, but to deploy the database locally by yourself. Also, you will need to run migrations - `npm run migrate` after the database would running.

### Task Requirements

1. Files with pictures must be saved in the directory `public/avatars`

2. The `public/avatars` directory must be kept up to date after each request completes. For example, there can be no situation when the directory contains pictures that are no longer tied to the user.

3. Requests must be implemented in the `REST` format to the entity `user` (for example, `GET` `/user/1` to get a user with `id` = `1`)

4. Fields of the entity `user`:

   ```javascript
   {
       id: Number, // autogenerated by sql
       username: String,
       email: String,
       avatar: String | File, // String for GET and File for PUT / POST / PATCH
       age: Number,
       phone: String,
   }
   ```

5. The picture file must be available by a `GET` request to the url from the `avatar` field. For example, in the `avatar` field, the user receives the string `http://localhost/33333.jpg` by inserting this url into the browser line, the user should see the picture.

6. In case of an error, the server should return an error with one of the `400` statuses.

7. The name of each picture must be guaranteed to be unique.
